<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Sá»• bÃ¡n hÃ ng</title>

<style>
body {
    font-family: Arial;
    background:#f2f2f2;
    padding:20px;
}

h2 {
    text-align:center;
    font-size:32px;
    margin-bottom:15px;
}

.box {
    background:white;
    border-radius:12px;
    padding:15px;
    margin-bottom:15px;
}

input, button {
    font-size:18px;
    padding:8px;
    width:100%;
    margin:5px 0;
}

button {
    border:none;
    border-radius:8px;
    color:white;
}

.add { background:#FF9800; }
.sell { background:#4CAF50; }
.update { background:#2196F3; }
.delete { background:#f44336; }

.row {
    display:flex;
    justify-content:space-between;
    padding:12px;
    border-bottom:1px solid #ddd;
    cursor:pointer;
    font-size:20px;
}

.detail {
    display:none;
    padding:10px;
    background:#fafafa;
    border-radius:8px;
    margin-bottom:10px;
}
</style>
</head>

<body>

<h2>ğŸ“’ Sá»” BÃN HÃ€NG</h2>

<!-- MENU -->
<div class="box">
    <a href="/export">
        <button style="background:#673AB7;">â¬‡ï¸ XUáº¤T EXCEL</button>
    </a>
</div>

<!-- THÃŠM Sáº¢N PHáº¨M -->
<div class="box">
<form method="post">
    <input type="hidden" name="action" value="add_product">
    <input name="name" placeholder="TÃªn sáº£n pháº©m" required>
    <input type="number" name="stock" placeholder="SL nháº­p" required>
    <input type="date" name="import_date" required>
    <button class="add">â• THÃŠM</button>
</form>
</div>

<!-- DANH SÃCH Sáº¢N PHáº¨M -->
<div class="box">
<h3>ğŸ“¦ Sáº¢N PHáº¨M</h3>

{% for p in products %}
<div class="row" onclick="toggle('{{ p[0] }}')">
    <b>{{ p[1] }}</b>
    <span>Tá»“n: {{ p[2] }}</span>
</div>

<div class="detail" id="d{{ p[0] }}">

    <!-- BÃN -->
    <form method="post">
        <input type="hidden" name="action" value="sell">
        <input type="hidden" name="product_id" value="{{ p[0] }}">
        <input type="date" name="sell_date" value="{{ today }}">
        <input type="number" name="quantity" placeholder="Sá»‘ lÆ°á»£ng bÃ¡n" required>
        <button class="sell">BÃN</button>
    </form>

    <!-- Cáº¬P NHáº¬T Tá»’N -->
    <form method="post">
        <input type="hidden" name="action" value="update_stock">
        <input type="hidden" name="product_id" value="{{ p[0] }}">
        <input type="number" name="new_stock" placeholder="Tá»“n má»›i" required>
        <button class="update">Sá»¬A Tá»’N</button>
    </form>

    <!-- XÃ“A -->
    <form method="post" onsubmit="return confirm('XÃ³a sáº£n pháº©m nÃ y?')">
        <input type="hidden" name="action" value="delete_product">
        <input type="hidden" name="product_id" value="{{ p[0] }}">
        <button class="delete">âŒ XÃ“A</button>
    </form>

</div>
{% endfor %}
</div>

<!-- Lá»ŠCH Sá»¬ BÃN -->
<div class="box">
<h3>ğŸ“Š Lá»ŠCH Sá»¬ BÃN</h3>

{% for s in sales %}
<div style="font-size:18px; margin:6px 0;">
ğŸ“… {{ s[0] }} â€” <b>{{ s[1] }}</b> â€” SL: {{ s[2] }}
</div>
{% endfor %}
</div>

<script>
function toggle(id){
    let d = document.getElementById("d"+id);
    d.style.display = d.style.display === "block" ? "none" : "block";
}
</script>

</body>
</html>
