<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>S·ªï b√°n h√†ng</title>

    <style>
        body {
            font-family: Arial, sans-serif;
            background: #f2f2f2;
            margin: 0;
            padding: 20px;
        }

        h2 {
            text-align: center;
            font-size: 32px;
            margin-bottom: 20px;
        }

        .box {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.1);
        }

        label {
            font-size: 20px;
        }

        input {
            font-size: 20px;
            padding: 8px;
            width: 100%;
            margin: 8px 0 12px;
        }

        button {
            font-size: 20px;
            padding: 12px;
            width: 100%;
            border: none;
            border-radius: 8px;
            margin-top: 5px;
        }

        .add {
            background: #FF9800;
            color: white;
        }

        .sell {
            background: #4CAF50;
            color: white;
        }

        .update {
            background: #2196F3;
            color: white;
        }

        .name {
            font-size: 26px;
            font-weight: bold;
        }

        .stock {
            font-size: 22px;
            margin: 10px 0 15px;
        }
    </style>
</head>

<body>
    <h2>S·ªî B√ÅN H√ÄNG</h2>
    <!-- MENU T√åM KI·∫æM & CH·ªåN S·∫¢N PH·∫®M -->
<div class="box">
    <input
        type="text"
        id="searchInput"
        placeholder="üîç T√¨m s·∫£n ph·∫©m..."
        onkeyup="searchProduct()"
    >

    <select id="productSelect" onchange="filterProduct()"
            style="font-size:20px; padding:8px; width:100%;">
        <option value="">-- Ch·ªçn s·∫£n ph·∫©m --</option>
        {% for p in products %}
            <option value="{{ p[0] }}">{{ p[1] }}</option>
        {% endfor %}
    </select>
</div>
<a href="/history">
    <button class="menu-btn"> ->üîç L·ªäCH S·ª¨ B√ÅN</button>
</a>


    <!-- TH√äM S·∫¢N PH·∫®M -->
    <div class="box">
        <form method="post">
            <input type="hidden" name="action" value="add_product">

            <label>T√™n s·∫£n ph·∫©m</label>
            <input type="text" name="name" required>

            <label>S·ªë l∆∞·ª£ng t·ªìn ban ƒë·∫ßu</label>
            <input type="number" name="stock" min="0" required>
            <label>Ng√†y nh·∫≠p kho</label>
            <input type="date" name="import_date" required>


            <button class="add">TH√äM S·∫¢N PH·∫®M</button>
        </form>
    </div>

    <!-- DANH S√ÅCH S·∫¢N PH·∫®M -->
    {% for p in products %}
    <div class="box product-item" data-id="{{ p[0] }}">
        <div class="name product-name">{{ p[1] }}</div>
        <div class="stock">T·ªìn hi·ªán t·∫°i: {{ p[2] }}</div>
        <div style="font-size:18px;color:#555;">
        Ng√†y nh·∫≠p kho: {{ p[3] }}</div>


        <!-- B√ÅN -->
        <form method="post">
            <input type="hidden" name="action" value="sell">
            <input type="hidden" name="product_id" value="{{ p[0] }}">

            <label>Ng√†y b√°n</label>
            <input type="date" name="sell_date" value="{{ today }}" required>
            <label>S·ªë l∆∞·ª£ng b√°n</label>
            <input type="number" name="quantity" min="1" required>

            <button class="sell">GHI B√ÅN</button>
        </form>

        <hr>

        <!-- C·∫¨P NH·∫¨T T·ªíN -->
        <form method="post">
            <input type="hidden" name="action" value="update_stock">
            <input type="hidden" name="product_id" value="{{ p[0] }}">

            <label>Ch·ªânh t·ªìn m·ªõi</label>
            <input type="number" name="new_stock" min="0" required>

            <button class="update">C·∫¨P NH·∫¨T T·ªíN</button>
        </form>
    </div>
    {% endfor %}
    <script>
function filterProduct() {
    const selectedId = document.getElementById("productSelect").value;
    const items = document.querySelectorAll(".product-item");

    items.forEach(item => {
        item.style.display =
            selectedId === "" || item.dataset.id === selectedId
            ? "block"
            : "none";
    });
}

function searchProduct() {
    const keyword = document.getElementById("searchInput").value.toLowerCase();
    const items = document.querySelectorAll(".product-item");

    items.forEach(item => {
        const name = item.querySelector(".product-name").innerText.toLowerCase();
        item.style.display = name.includes(keyword) ? "block" : "none";
    });
}
</script>


    {% for s in sales %}
        <div style="font-size:20px; margin:10px 0;">
         B√°n: {{ s[0] }} ‚Äî <b>{{ s[1] }}</b> ‚Äî SL: {{ s[2] }}
        <br>
        üì¶ Nh·∫≠p kho: {{ s[3] }}

        </div>
    {% endfor %}
</div>

</body>
</html>
